<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Retro Multi-Time-Zone Clock — Enhanced</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="dark">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header id="toolbar" aria-label="Clock controls">
    <div id="modeIndicator" role="status" aria-live="polite" aria-atomic="true" class="modeBadge">Realtime</div>

    <div class="controlGroup">
      <label for="deltaRange" class="sr-only">Adjust minutes</label>
      <input id="deltaRange" type="range" min="-1440" max="1440" step="1" aria-label="Adjust minutes">
    </div>

    <div class="controlGroup">
      <label for="deltaNumber" class="sr-only">Adjust minutes exact</label>
      <input id="deltaNumber" type="number" min="-1440" max="1440" step="1" aria-label="Adjust minutes exact" inputmode="numeric">
    </div>

    <div class="controlGroup">
      <button id="resetBtn" class="btn" type="button" title="Reset to real time">Reset</button>
    </div>

    <div class="controlGroup">
      <button id="copyMenuBtn" class="btn" type="button" aria-haspopup="menu" aria-expanded="false" aria-controls="copyMenu">Copy ▼</button>
      <div id="copyMenu" role="menu" class="menu" hidden>
        <div class="menuHeader">Copy format</div>
        <button role="menuitem" data-format="tsv">TSV</button>
        <button role="menuitem" data-format="csv">CSV</button>
        <button role="menuitem" data-format="md">Markdown table</button>
        <button role="menuitem" data-format="human">Human list</button>
        <div class="menuDivider"></div>
        <div class="menuHeader">Scope</div>
        <label class="menuCheck"><input type="radio" name="copyScope" value="all" checked> All clocks</label>
        <label class="menuCheck"><input type="radio" name="copyScope" value="visible"> Visible only</label>
      </div>
    </div>

    <div class="controlGroup toggle12h">
      <input id="h12" type="checkbox" aria-pressed="false" aria-label="Use 12-hour time">
      <label for="h12" title="Toggle 12-hour time">12 h</label>
    </div>

    <div class="controlGroup">
      <button id="densityBtn" class="btn" type="button" aria-pressed="false" title="Toggle dense layout">Dense</button>
    </div>

    <div class="controlGroup">
      <button id="paletteBtn" class="btn" type="button" aria-pressed="false" title="Toggle color-blind palette">Palette</button>
    </div>

    <div class="controlGroup">
      <button id="plannerBtn" class="btn" type="button" aria-pressed="false" title="Toggle planner strip">Planner</button>
    </div>

    <div class="controlGroup">
      <button id="fullscreenBtn" class="btn" type="button" title="Enter fullscreen">Fullscreen</button>
    </div>

    <div class="controlGroup">
      <button id="exportBtn" class="btn" type="button" title="Export PNG snapshot">Export</button>
    </div>

    <div class="controlGroup">
      <button id="filterBtn" class="btn" type="button" aria-haspopup="menu" aria-expanded="false" aria-controls="filterMenu" title="Show/hide clocks">Visible ▼</button>
      <div id="filterMenu" role="menu" class="menu menu-wide" hidden>
        <div class="menuHeader">Visible clocks</div>
        <!-- Items injected by JS -->
      </div>
    </div>

    <div class="controlGroup jumpGroup">
      <label for="jumpInput" class="sr-only">Jump to time (YYYY-MM-DD HH:MM)</label>
      <input id="jumpInput" type="text" placeholder="YYYY-MM-DD HH:MM" aria-label="Jump to time (device local)">
      <button id="jumpBtn" class="btn" type="button" title="Jump to this time">Jump</button>
    </div>

    <div class="controlGroup">
      <button id="helpBtn" class="btn" type="button" title="Help and shortcuts">Help ?</button>
    </div>
  </header>

  <section id="planner" aria-label="Meeting planner" hidden>
    <!-- planner rows inserted by JS -->
  </section>

  <main id="grid" role="list" aria-label="Clocks grid">
    <!-- rows inserted by JS -->
  </main>

  <div id="toast" role="status" aria-live="polite" aria-atomic="true"></div>

  <!-- Help Modal -->
  <div id="helpModal" role="dialog" aria-modal="true" aria-labelledby="helpTitle" hidden>
    <div class="modalCard">
      <header class="modalHeader">
        <h2 id="helpTitle">Retro Multi-Time-Zone Clock — Help</h2>
        <button id="helpClose" class="btn small" type="button" aria-label="Close help">✕</button>
      </header>
      <div class="modalBody" tabindex="0">
        <p>This app shows multiple fixed-offset clocks with a retro CRT look. It supports Real-Time (device now) and Adjusted (what-if) modes.</p>
        <h3>Basics</h3>
        <ul>
          <li><b>Realtime</b>: Delta = 0. Ticks every second.</li>
          <li><b>Adjusted</b>: Move the slider or number input to set a delta (minutes). All clocks shift by this amount.</li>
          <li><b>12 h</b> toggle: Switches between 24-hour and 12-hour display.</li>
          <li><b>Copy</b>: Per-row copies one time. <b>Copy ▼</b> opens a menu with formats (TSV/CSV/Markdown/Human) and scope (All/Visible).</li>
        </ul>
        <h3>Enhancements</h3>
        <ul>
          <li><b>Business hours shading</b>: Rows highlight during 09:00–17:00 (per clock; configurable in code).</li>
          <li><b>Yesterday/Today/Tomorrow</b> chip compares to your device’s current date.</li>
          <li><b>Seconds ring</b>: Tiny ring sweeping once per minute (no blinking).</li>
          <li><b>Temporary nudge</b>: Per-row −30m / +30m / reset without affecting other clocks.</li>
          <li><b>Density/Palette</b>: Dense layout fits more; Palette toggles a color-blind friendly scheme.</li>
          <li><b>Planner</b>: 24-hour strip per city with working-hour bands and a moving marker.</li>
          <li><b>Fullscreen/Kiosk</b>: Fullscreen display; <code>#kiosk=1</code> hides the toolbar (press <kbd>F</kbd> to enter fullscreen).</li>
          <li><b>Share URL</b>: Hash stores delta (<code>d</code>), 12h (<code>h=12</code>), order (<code>order=</code>), visible IDs (<code>ids=</code>), density (<code>z=dense</code>), palette (<code>p=hc</code>), planner (<code>pl=1</code>), and kiosk (<code>kiosk=1</code>).</li>
        </ul>
        <h3>Keyboard Shortcuts</h3>
        <ul>
          <li><kbd>+</kbd>/<kbd>-</kbd> ±1 minute, <kbd>Shift</kbd> + <kbd>+</kbd>/<kbd>-</kbd> ±15 minutes</li>
          <li><kbd>0</kbd> reset to real time</li>
          <li><kbd>C</kbd> copy (opens menu)</li>
          <li><kbd>H</kbd> toggle 12 h</li>
          <li><kbd>D</kbd> toggle Dense</li>
          <li><kbd>P</kbd> toggle Planner</li>
          <li><kbd>F</kbd> enter/exit Fullscreen</li>
          <li><kbd>X</kbd> export PNG snapshot</li>
          <li><kbd>?</kbd> open this help</li>
          <li><kbd>Esc</kbd> close menus/help</li>
        </ul>
        <h3>Privacy & Safety</h3>
        <ul>
          <li>No network requests; no storage. Clipboard used only on your action.</li>
          <li>Offsets are fixed and do not auto-adjust for DST.</li>
        </ul>
      </div>
      <footer class="modalFooter">
        <button id="helpClose2" class="btn" type="button">Close</button>
      </footer>
    </div>
  </div>

  <!-- Kiosk hint overlay -->
  <div id="kioskHint" hidden>
    <div class="hintCard">
      <p>Kiosk mode is active. Press <b>F</b> or click to enter fullscreen.</p>
      <button id="kioskEnter" class="btn">Enter Fullscreen</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>

